<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>발령 등록</title>
    <link rel="stylesheet" th:href="@{/css/empManage/hrRegist.css}">
    <script src="http://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body onresize="parent.resizeTo(900, 600)" onload="parent.resizeTo(900,600)">
    <h1>발령 등록</h1>
    <form th:action="@{/emp/hrRegist}" method="post" id="hrRegist">
        <input type="hidden" name="${}">
        <table>
            <tr>
                <th>발령구분</th>
                <td><select name="category">
                    <option>선택</option>
                    <option value="승진">승진</option>
                    <option value="부서이동">부서이동</option>
                </select></td>
            </tr>
            <tr>
                <th>발령일자</th>
                <td><input type="date" name="date"></td>
            </tr>
            <tr class="mem_num">
                <th>사원번호</th>
                <td id="selectNum">
                    <input type="text" name="mem_num" id="mem_num">
                    <button type="button" id="send">검색</button>
                </td>
                <th>직원명</th>
                <td id="name" class="greyBox"></td>
            </tr>
            <tr>
                <th>직급</th>
                <td id="rank" class="greyBox"></td>
                <th>발령직급</th>
                <td>
                    <select name="dept_rank">
                    <option>선택</option>
                    <option value="사원">사원</option>
                    <option value="대리">대리</option>
                    <option value="과장">과장</option>
                    <option value="사장">사장</option>
                    <option value="회장">회장</option>
                    </select>
                </td>
            </tr>
            <tr>
                <th>부서</th>
                <td id="dept_name" class="greyBox"></td>
                <th>발령부서</th>
                <td><select name="dept_name">
                    <option>선택</option>
                    <option value="인사부">인사부</option>
                    <option value="기술지원부">기술지원부</option>
                    <option value="영업1부">영업1부</option>
                    <option value="영업2부">영업2부</option>
                    <option value="사업부">사업부</option>
                </select></td>
            </tr>
            <tr>
                <th>비고</th>
                <td class="widthText" colspan="4"><input type="text" name="contents"></td>
            </tr>
        </table>
            <input type="hidden" name="bef_rank" id="bef_rank">
            <input type="hidden" name="bef_dept" id="bef_dept">
        <button type="submit" onclick="">저장</button>
    </form>
    <script>

        let mem_num = $("#mem_num").val();

        $("#send").click(function(){
            $.ajax({
               url: "getMemberName?mem_num=" + $("#mem_num").val(),
               type: "GET",
               contentType: "application/json;charset=UTF-8",
               dataType: "json",
               success: function(data){

                   console.log('data 나오나여 : ' + data)

                   $("#name").append("<p class='pGrey'>" + data.mem_name + "</p>");
                   $("#rank").append("<p class='pGrey'>" + data.dept_rank + "</p>");
                   $("#dept_name").append("<p class='pGrey'>" + data.department.dept_name + "</p>");
                   $("#bef_rank").val(data.dept_rank);
                   $("#bef_dept").val(data.department.dept_name);
               } ,
                error: function(error){
                   console.log('에러 발생했어여ㅠ.. ' + error);
                }
            });
        });

    </script>
</body>
</html>